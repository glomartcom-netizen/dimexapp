<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DimeX</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
.top{display:flex;flex-direction:column;align-items:center;padding:30px 0}
.btn{background:gold;border:none;padding:12px 20px;border-radius:8px;font-weight:bold;cursor:pointer}
.btn:disabled{opacity:.4}
.container{display:flex}
.left{width:60%;padding:20px}
.right{width:40%;padding:20px}
.statGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.statBox{background:#111;padding:14px;border-radius:12px}
.statBox h4{margin:0;font-size:13px;color:#aaa}
.statValue{color:gold;font-size:18px;font-weight:bold;margin-top:5px}
.card{background:#111;padding:15px;border-radius:12px;margin:10px}
.amount{color:gold;font-size:20px;font-weight:bold}
input{padding:10px;width:90%;margin:10px;background:#000;color:#fff;border:1px solid #333}
.centerCard{display:flex;justify-content:center}
.centerColumn{display:flex;flex-direction:column;align-items:center;gap:15px}
#wallet{text-align:center;color:#aaa}
#status{text-align:center;color:gold}
@media(max-width:900px){.container{flex-direction:column}.left,.right{width:100%}}
</style>
</head>

<body>

<div style="text-align:center;padding:25px 0;">

<div style="
display:flex;
justify-content:center;
align-items:center;
gap:14px;
">

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB4AAAAeACAYAAAB0t0wBAAAgAElEQVR4nOzdeZgkV3n/8fdnZ2d3ZlV3..."
style="width:90px;">

<div style="
font-size:30px;
font-weight:bold;
color:gold;
letter-spacing:1px;
">
DimeX Dashboard
</div>

</div>

<div style="margin-top:15px;">
<button class="btn" onclick="connect()">Connect Wallet</button>
</div>

</div>
<div id="wallet"></div>
<div id="status"></div>

<div class="container">

<!-- LEFT PANEL -->
<div class="left">

<div class="statGrid">

<div class="statBox">
<h4>üí∞ Total Stake</h4>
<div id="totalStake" class="statValue">0</div>
</div>

<div class="statBox">
<h4>ü™ô Daily Reward</h4>
<div id="dailyReward" class="statValue">0</div>
</div>

<div class="statBox">
<h4>üèÜ Total Income</h4>
<div id="totalIncome" class="statValue">0</div>
</div>

<div class="statBox">
<h4>üë• Direct Income</h4>
<div id="directIncome" class="statValue">0</div>
</div>

<div class="statBox">
<h4>üìä Level Income</h4>
<div id="levelIncome" class="statValue">0</div>
</div>

<div class="statBox">
<h4>üåê Team Count</h4>
<div id="teamCount" class="statValue">0</div>
</div>

</div>

<div class="card">
<h3>üîó Referral Link</h3>
<input id="refInput" readonly style="color:gold;width:90%">
<button class="btn" onclick="copyRef()">COPY</button>
<div id="copyMsg"></div>
</div>

</div>

<!-- RIGHT PANEL -->
<div class="right">

<div class="card centerCard">
<button class="btn" onclick="toggleStake()"> STAKE</button>
</div>

<div id="stakeBox" style="display:none">

<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">

<div class="card">
<h3>USDT</h3>
<input id="usdtAmount">
<button class="btn" onclick="approveUSDT()">Approve</button>
<button class="btn" onclick="stakeUSDT()">Stake</button>
</div>

<div class="card">
<h3>DX</h3>
<input id="dxAmount">
<button class="btn" onclick="approveDX()">Approve</button>
<button class="btn" onclick="stakeDX()">Stake</button>
</div>

</div>
</div>

<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">

<div class="card centerColumn">
<h3> Claimable</h3>
<div id="claimAmount" class="amount">0</div>
<button id="claimBtn" class="btn" onclick="claim()" disabled>CLAIM</button>
</div>

<div class="card centerColumn">
<button class="btn" onclick="toggleDownline()"> VIEW DOWNLINE</button>
<button class="btn" onclick="toggleHistory()"> CLAIM HISTORY</button>
</div>

</div>

<div id="downlineBox" style="display:none" class="card"></div>
<div id="historyBox" style="display:none" class="card"></div>

</div>
</div>

<script>
let provider, signer, staking, usdt, dx;

const stakingAddress="PASTE_STAKING";
const dxAddress="PASTE_DX";
const usdtAddress="0x55d398326f99059fF775485246999027B3197955";

const stakingABI=[
"function stakeUSDT(uint amount,address ref)",
"function stakeDX(uint amount,address ref)",
"function claim()",
"function userInfo(address) view returns(uint,uint,uint,uint,uint,uint)"
];

const erc20ABI=[
"function approve(address spender,uint amount) returns(bool)"
];

function setStatus(msg){document.getElementById("status").innerHTML=msg;}

function toggleStake(){
let box=document.getElementById("stakeBox");
box.style.display=box.style.display=="none"?"block":"none";
}
function toggleDownline(){
let b=document.getElementById("downlineBox");
b.style.display=b.style.display=="none"?"block":"none";
}
function toggleHistory(){
let b=document.getElementById("historyBox");
b.style.display=b.style.display=="none"?"block":"none";
}

async function connect(){
await window.ethereum.request({method:'eth_requestAccounts'});
provider=new ethers.providers.Web3Provider(window.ethereum);
signer=provider.getSigner();

const net=await provider.getNetwork();
if(net.chainId!==56){alert("Switch to BSC");return;}

staking=new ethers.Contract(stakingAddress,stakingABI,signer);
usdt=new ethers.Contract(usdtAddress,erc20ABI,signer);
dx=new ethers.Contract(dxAddress,erc20ABI,signer);

let addr=await signer.getAddress();
document.getElementById("wallet").innerHTML="Wallet: "+addr;

setRef();
loadData();
setInterval(loadData,10000);
}

async function setRef(){
let addr=await signer.getAddress();
document.getElementById("refInput").value=window.location.origin+"?ref="+addr;
}

function copyRef(){
navigator.clipboard.writeText(document.getElementById("refInput").value);
document.getElementById("copyMsg").innerHTML="Copied";
}

async function loadData(){
let addr=await signer.getAddress();
let d=await staking.userInfo(addr);
let pending=d[5];

document.getElementById("totalStake").innerHTML=ethers.utils.formatUnits(d[0],18);
document.getElementById("dailyReward").innerHTML=ethers.utils.formatUnits(d[1],18);
document.getElementById("totalIncome").innerHTML=ethers.utils.formatUnits(d[2],18);
document.getElementById("directIncome").innerHTML=ethers.utils.formatUnits(d[3],18);
document.getElementById("levelIncome").innerHTML=ethers.utils.formatUnits(d[4],18);
document.getElementById("claimAmount").innerHTML=ethers.utils.formatUnits(pending,18);

let btn=document.getElementById("claimBtn");
btn.disabled = pending < ethers.utils.parseUnits("100",18);
}

async function approveUSDT(){
setStatus("Approving USDT...");
let amt=document.getElementById("usdtAmount").value;
let tx=await usdt.approve(stakingAddress,ethers.utils.parseUnits(amt,18));
await tx.wait();
setStatus("Approved");
}

async function approveDX(){
setStatus("Approving DX...");
let amt=document.getElementById("dxAmount").value;
let tx=await dx.approve(stakingAddress,ethers.utils.parseUnits(amt,18));
await tx.wait();
setStatus("Approved");
}

async function stakeUSDT(){
setStatus("Staking...");
let amt=document.getElementById("usdtAmount").value;
let ref="0x0000000000000000000000000000000000000000";
let tx=await staking.stakeUSDT(ethers.utils.parseUnits(amt,18),ref);
await tx.wait();
setStatus("Done");
loadData();
}

async function stakeDX(){
setStatus("Staking...");
let amt=document.getElementById("dxAmount").value;
let ref="0x0000000000000000000000000000000000000000";
let tx=await staking.stakeDX(ethers.utils.parseUnits(amt,18),ref);
await tx.wait();
setStatus("Done");
loadData();
}

async function claim(){
setStatus("Claiming...");
let tx=await staking.claim();
await tx.wait();
setStatus("Claimed");
loadData();
}
</script>

</body>
  </html>
